<!DOCTYPE html>
<html>
<head>
<script
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script>
<script>
$(document).ready(function(){
	var playerId = localStorage.getItem('playerId');
 	if (playerId == '' || playerId == 'undefined' || playerId < 1){
		  window.location.href="./login.html";
	}
 	$('#playerId').append(playerId);
	$('#email').append(localStorage.getItem('email'));
//	alert("playerId 2: "+ localStorage.getItem('playerId'));
	$.ajax({
		headers: {
	    	"Content-Type" : "application/json",
	    	"Accept" : "application/json",
	    	"playerId" : +localStorage.getItem('playerId')
	    },
		type: "GET",
		url: "http://gogomaya.cloudfoundry.com/spi/active/options",
		success: function(data, textStatus, jqXHR ) {			  
 			$.each( data.specifications, function( key, value ) {
 				$('<button>', {
 					text: value.betRule.price,
 					class: 'cBids',
 					id: value.betRule.price
 				}).appendTo("#bids");
 	 	    	$('<P>').appendTo('#bids');
 	 	    	$("#"+value.betRule.price).data("spec", value);
			});
 			$(".cBids").click(function(){
// 				alert(this.id + " selected");
// 	 	    	alert(JSON.stringify($(this).data("spec"), null, 2));
 				$.ajax({
 					headers: {
 				    	"Content-Type" : "application/json",
 				    	"Accept" : "application/json",
 				    	"playerId" : +localStorage.getItem('playerId')
 				    },
 					type: "POST",
 					url: "http://gogomaya.cloudfoundry.com/spi/active/session",
 					//data: this.data("spec"),
 				 	data: JSON.stringify($(this).data("spec"), null, 2),
 					success: function(data, textStatus, jqXHR ) {
 						alert("Data:\n" + JSON.stringify(data, null, 2));
 					},
 					error: function(data) {
 						alert("Errrrror:\n" + JSON.stringify(data, null, 2));
 					}
 				});
 			});
		},
		error: function(data) {
			alert("Errrrror:\n" + JSON.stringify(data, null, 2));
		}
	});
});
</script>
</head>
<title>Go-Go Bids</title>

<body>
<span id="playerId">Player ID = </span><br>
<span id="email">Email = </span>
<p>
	<h1>Choose Your Bid</h1>
	<div id="bids"></div>
</body>
</html>
